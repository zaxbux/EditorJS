(function(W,U){typeof exports=="object"&&typeof module<"u"?module.exports=U():typeof define=="function"&&define.amd?define(U):(W=typeof globalThis<"u"?globalThis:W||self,W.LinkAutocomplete=U())})(this,function(){"use strict";function W(A){return A&&A.__esModule&&Object.prototype.hasOwnProperty.call(A,"default")?A.default:A}var U={exports:{}};/*! For license information please see link-autocomplete.js.LICENSE.txt */(function(A,Z){(function(P,M){A.exports=M()})(self,function(){return(()=>{var P={580:_=>{_.exports=function(m){var w={};function u(o){if(w[o])return w[o].exports;var s=w[o]={i:o,l:!1,exports:{}};return m[o].call(s.exports,s,s.exports,u),s.l=!0,s.exports}return u.m=m,u.c=w,u.d=function(o,s,l){u.o(o,s)||Object.defineProperty(o,s,{enumerable:!0,get:l})},u.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},u.t=function(o,s){if(1&s&&(o=u(o)),8&s||4&s&&typeof o=="object"&&o&&o.__esModule)return o;var l=Object.create(null);if(u.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:o}),2&s&&typeof o!="string")for(var b in o)u.d(l,b,function(v){return o[v]}.bind(null,b));return l},u.n=function(o){var s=o&&o.__esModule?function(){return o.default}:function(){return o};return u.d(s,"a",s),s},u.o=function(o,s){return Object.prototype.hasOwnProperty.call(o,s)},u.p="/",u(u.s=0)}([function(m,w,u){u(1),m.exports=function(){var o=u(6),s=null;return{show:function(l){if(l.message){(function(){if(s)return!0;s=o.getWrapper(),document.body.appendChild(s)})();var b=null,v=l.time||8e3;switch(l.type){case"confirm":b=o.confirm(l);break;case"prompt":b=o.prompt(l);break;default:b=o.alert(l),window.setTimeout(function(){b.remove()},v)}s.appendChild(b),b.classList.add("cdx-notify--bounce-in")}}}}()},function(m,w,u){var o=u(2);typeof o=="string"&&(o=[[m.i,o,""]]),u(4)(o,{hmr:!0,transform:void 0,insertInto:void 0}),o.locals&&(m.exports=o.locals)},function(m,w,u){(m.exports=u(3)(!1)).push([m.i,`.cdx-notify--error{background:#fffbfb!important}.cdx-notify--error::before{background:#fb5d5d!important}.cdx-notify__input{max-width:130px;padding:5px 10px;background:#f7f7f7;border:0;border-radius:3px;font-size:13px;color:#656b7c;outline:0}.cdx-notify__input:-ms-input-placeholder{color:#656b7c}.cdx-notify__input::placeholder{color:#656b7c}.cdx-notify__input:focus:-ms-input-placeholder{color:rgba(101,107,124,.3)}.cdx-notify__input:focus::placeholder{color:rgba(101,107,124,.3)}.cdx-notify__button{border:none;border-radius:3px;font-size:13px;padding:5px 10px;cursor:pointer}.cdx-notify__button:last-child{margin-left:10px}.cdx-notify__button--cancel{background:#f2f5f7;box-shadow:0 2px 1px 0 rgba(16,19,29,0);color:#656b7c}.cdx-notify__button--cancel:hover{background:#eee}.cdx-notify__button--confirm{background:#34c992;box-shadow:0 1px 1px 0 rgba(18,49,35,.05);color:#fff}.cdx-notify__button--confirm:hover{background:#33b082}.cdx-notify__btns-wrapper{display:-ms-flexbox;display:flex;-ms-flex-flow:row nowrap;flex-flow:row nowrap;margin-top:5px}.cdx-notify__cross{position:absolute;top:5px;right:5px;width:10px;height:10px;padding:5px;opacity:.54;cursor:pointer}.cdx-notify__cross::after,.cdx-notify__cross::before{content:'';position:absolute;left:9px;top:5px;height:12px;width:2px;background:#575d67}.cdx-notify__cross::before{transform:rotate(-45deg)}.cdx-notify__cross::after{transform:rotate(45deg)}.cdx-notify__cross:hover{opacity:1}.cdx-notifies{position:fixed;z-index:2;bottom:20px;left:20px;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif}.cdx-notify{position:relative;width:220px;margin-top:15px;padding:13px 16px;background:#fff;box-shadow:0 11px 17px 0 rgba(23,32,61,.13);border-radius:5px;font-size:14px;line-height:1.4em;word-wrap:break-word}.cdx-notify::before{content:'';position:absolute;display:block;top:0;left:0;width:3px;height:calc(100% - 6px);margin:3px;border-radius:5px;background:0 0}@keyframes bounceIn{0%{opacity:0;transform:scale(.3)}50%{opacity:1;transform:scale(1.05)}70%{transform:scale(.9)}100%{transform:scale(1)}}.cdx-notify--bounce-in{animation-name:bounceIn;animation-duration:.6s;animation-iteration-count:1}.cdx-notify--success{background:#fafffe!important}.cdx-notify--success::before{background:#41ffb1!important}`,""])},function(m,w){m.exports=function(u){var o=[];return o.toString=function(){return this.map(function(s){var l=function(b,v){var C,d=b[1]||"",c=b[3];if(!c)return d;if(v&&typeof btoa=="function"){var S=(C=c,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(C))))+" */"),e=c.sources.map(function(t){return"/*# sourceURL="+c.sourceRoot+t+" */"});return[d].concat(e).concat([S]).join(`
`)}return[d].join(`
`)}(s,u);return s[2]?"@media "+s[2]+"{"+l+"}":l}).join("")},o.i=function(s,l){typeof s=="string"&&(s=[[null,s,""]]);for(var b={},v=0;v<this.length;v++){var C=this[v][0];typeof C=="number"&&(b[C]=!0)}for(v=0;v<s.length;v++){var d=s[v];typeof d[0]=="number"&&b[d[0]]||(l&&!d[2]?d[2]=l:l&&(d[2]="("+d[2]+") and ("+l+")"),o.push(d))}},o}},function(m,w,u){var o,s,l={},b=(o=function(){return window&&document&&document.all&&!window.atob},function(){return s===void 0&&(s=o.apply(this,arguments)),s}),v=function(p){var a={};return function(f){if(typeof f=="function")return f();if(a[f]===void 0){var g=function(L){return document.querySelector(L)}.call(this,f);if(window.HTMLIFrameElement&&g instanceof window.HTMLIFrameElement)try{g=g.contentDocument.head}catch{g=null}a[f]=g}return a[f]}}(),C=null,d=0,c=[],S=u(5);function e(p,a){for(var f=0;f<p.length;f++){var g=p[f],L=l[g.id];if(L){L.refs++;for(var y=0;y<L.parts.length;y++)L.parts[y](g.parts[y]);for(;y<g.parts.length;y++)L.parts.push(x(g.parts[y],a))}else{var D=[];for(y=0;y<g.parts.length;y++)D.push(x(g.parts[y],a));l[g.id]={id:g.id,refs:1,parts:D}}}}function t(p,a){for(var f=[],g={},L=0;L<p.length;L++){var y=p[L],D=a.base?y[0]+a.base:y[0],k={css:y[1],media:y[2],sourceMap:y[3]};g[D]?g[D].parts.push(k):f.push(g[D]={id:D,parts:[k]})}return f}function i(p,a){var f=v(p.insertInto);if(!f)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var g=c[c.length-1];if(p.insertAt==="top")g?g.nextSibling?f.insertBefore(a,g.nextSibling):f.appendChild(a):f.insertBefore(a,f.firstChild),c.push(a);else if(p.insertAt==="bottom")f.appendChild(a);else{if(typeof p.insertAt!="object"||!p.insertAt.before)throw new Error(`[Style Loader]

 Invalid value for parameter 'insertAt' ('options.insertAt') found.
 Must be 'top', 'bottom', or Object.
 (https://github.com/webpack-contrib/style-loader#insertat)
`);var L=v(p.insertInto+" "+p.insertAt.before);f.insertBefore(a,L)}}function n(p){if(p.parentNode===null)return!1;p.parentNode.removeChild(p);var a=c.indexOf(p);a>=0&&c.splice(a,1)}function r(p){var a=document.createElement("style");return p.attrs.type===void 0&&(p.attrs.type="text/css"),h(a,p.attrs),i(p,a),a}function h(p,a){Object.keys(a).forEach(function(f){p.setAttribute(f,a[f])})}function x(p,a){var f,g,L,y;if(a.transform&&p.css){if(!(y=a.transform(p.css)))return function(){};p.css=y}if(a.singleton){var D=d++;f=C||(C=r(a)),g=T.bind(null,f,D,!1),L=T.bind(null,f,D,!0)}else p.sourceMap&&typeof URL=="function"&&typeof URL.createObjectURL=="function"&&typeof URL.revokeObjectURL=="function"&&typeof Blob=="function"&&typeof btoa=="function"?(f=function(k){var B=document.createElement("link");return k.attrs.type===void 0&&(k.attrs.type="text/css"),k.attrs.rel="stylesheet",h(B,k.attrs),i(k,B),B}(a),g=function(k,B,O){var I=O.css,j=O.sourceMap,V=B.convertToAbsoluteUrls===void 0&&j;(B.convertToAbsoluteUrls||V)&&(I=S(I)),j&&(I+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(j))))+" */");var $=new Blob([I],{type:"text/css"}),z=k.href;k.href=URL.createObjectURL($),z&&URL.revokeObjectURL(z)}.bind(null,f,a),L=function(){n(f),f.href&&URL.revokeObjectURL(f.href)}):(f=r(a),g=function(k,B){var O=B.css,I=B.media;if(I&&k.setAttribute("media",I),k.styleSheet)k.styleSheet.cssText=O;else{for(;k.firstChild;)k.removeChild(k.firstChild);k.appendChild(document.createTextNode(O))}}.bind(null,f),L=function(){n(f)});return g(p),function(k){if(k){if(k.css===p.css&&k.media===p.media&&k.sourceMap===p.sourceMap)return;g(p=k)}else L()}}m.exports=function(p,a){if(typeof DEBUG<"u"&&DEBUG&&typeof document!="object")throw new Error("The style-loader cannot be used in a non-browser environment");(a=a||{}).attrs=typeof a.attrs=="object"?a.attrs:{},a.singleton||typeof a.singleton=="boolean"||(a.singleton=b()),a.insertInto||(a.insertInto="head"),a.insertAt||(a.insertAt="bottom");var f=t(p,a);return e(f,a),function(g){for(var L=[],y=0;y<f.length;y++){var D=f[y];(k=l[D.id]).refs--,L.push(k)}for(g&&e(t(g,a),a),y=0;y<L.length;y++){var k;if((k=L[y]).refs===0){for(var B=0;B<k.parts.length;B++)k.parts[B]();delete l[k.id]}}}};var E,R=(E=[],function(p,a){return E[p]=a,E.filter(Boolean).join(`
`)});function T(p,a,f,g){var L=f?"":g.css;if(p.styleSheet)p.styleSheet.cssText=R(a,L);else{var y=document.createTextNode(L),D=p.childNodes;D[a]&&p.removeChild(D[a]),D.length?p.insertBefore(y,D[a]):p.appendChild(y)}}},function(m,w){m.exports=function(u){var o=typeof window<"u"&&window.location;if(!o)throw new Error("fixUrls requires window.location");if(!u||typeof u!="string")return u;var s=o.protocol+"//"+o.host,l=s+o.pathname.replace(/\/[^\/]*$/,"/");return u.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(b,v){var C,d=v.trim().replace(/^"(.*)"$/,function(c,S){return S}).replace(/^'(.*)'$/,function(c,S){return S});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(d)?b:(C=d.indexOf("//")===0?d:d.indexOf("/")===0?s+d:l+d.replace(/^\.\//,""),"url("+JSON.stringify(C)+")")})}},function(m,w,u){var o,s,l,b,v,C;m.exports=(o="cdx-notify",s="cdx-notify__cross",l="cdx-notify__button--confirm",b="cdx-notify__button",v="cdx-notify__btns-wrapper",{alert:C=function(d){var c=document.createElement("DIV"),S=document.createElement("DIV"),e=d.message,t=d.style;return c.classList.add(o),t&&c.classList.add(o+"--"+t),c.innerHTML=e,S.classList.add(s),S.addEventListener("click",c.remove.bind(c)),c.appendChild(S),c},confirm:function(d){var c=C(d),S=document.createElement("div"),e=document.createElement("button"),t=document.createElement("button"),i=c.querySelector("."+s),n=d.cancelHandler,r=d.okHandler;return S.classList.add(v),e.innerHTML=d.okText||"Confirm",t.innerHTML=d.cancelText||"Cancel",e.classList.add(b),t.classList.add(b),e.classList.add(l),t.classList.add("cdx-notify__button--cancel"),n&&typeof n=="function"&&(t.addEventListener("click",n),i.addEventListener("click",n)),r&&typeof r=="function"&&e.addEventListener("click",r),e.addEventListener("click",c.remove.bind(c)),t.addEventListener("click",c.remove.bind(c)),S.appendChild(e),S.appendChild(t),c.appendChild(S),c},prompt:function(d){var c=C(d),S=document.createElement("div"),e=document.createElement("button"),t=document.createElement("input"),i=c.querySelector("."+s),n=d.cancelHandler,r=d.okHandler;return S.classList.add(v),e.innerHTML=d.okText||"Ok",e.classList.add(b),e.classList.add(l),t.classList.add("cdx-notify__input"),d.placeholder&&t.setAttribute("placeholder",d.placeholder),d.default&&(t.value=d.default),d.inputType&&(t.type=d.inputType),n&&typeof n=="function"&&i.addEventListener("click",n),r&&typeof r=="function"&&e.addEventListener("click",function(){r(t.value)}),e.addEventListener("click",c.remove.bind(c)),S.appendChild(t),S.appendChild(e),c.appendChild(S),c},getWrapper:function(){var d=document.createElement("DIV");return d.classList.add("cdx-notifies"),d}})}])},384:(_,m,w)=>{w.d(m,{Z:()=>s});var u=w(645),o=w.n(u)()(function(l){return l[1]});o.push([_.id,`.ce-link-autocomplete__icon-wrapper svg {
        display: block;
    }
    .ce-link-autocomplete__actions-wrapper {
        border-top: 1px solid #E8E8EB;
        width: 200px;
    }
    .ce-link-autocomplete__field {
        position: relative;
    }
    .ce-link-autocomplete__field-input {
            width: calc(100% - 12px);
            margin: 6px;
            padding: 7px 10px;
            border-radius: 5px;
            border: solid 1px #E8E8EB;
            background-color: rgba(232, 232, 235, 0.49);
            outline: none;
            -webkit-appearance: none;
            box-sizing: border-box;
            font-size: 14px;
            font-weight: 500;
            letter-spacing: -0.15px;
            font-family: inherit;
        }
    .ce-link-autocomplete__field-input::placeholder {
                color: #7B7E89;
            }
    /**
         * Loader created in DOM but hidden bu default
         */
    .ce-link-autocomplete__field::after {

            content: '';
            position: absolute;
            right: 16px;
            top: 50%;
            margin-top: calc(14px / 2 * -1);

            width: 14px;
            height: 14px;
            border: 2px solid rgba(29, 32, 43, 0.3);
            border-top: 2px solid transparent;
            border-radius: 50%;
            opacity: 0;
            will-change: transform, opacity;
            box-sizing: border-box;
        }
    .ce-link-autocomplete__field--loading::after {
            animation: ce-link-autocomplete__spin 1s linear infinite;
            opacity: 1;
        }
    .ce-link-autocomplete__items {
        margin: 0 6px;
    }
    .ce-link-autocomplete__search-item {
        outline: none;
        border: 0;
        border-radius: 5px;
        font-size: 14px;
        padding: 7px 10px;
        margin-bottom: 6px;
        box-sizing: border-box;
        cursor: pointer;
    }
    .ce-link-autocomplete__search-item:not(:last-of-type) {
        }
    .ce-link-autocomplete__search-item:hover, .ce-link-autocomplete__search-item--selected {
            background-color: rgba(232, 232, 235, 0.49);
        }
    .ce-link-autocomplete__search-item-name {
            font-size: 14px;
            line-height: 16px;

            overflow:hidden;
            white-space:nowrap;
            text-overflow: ellipsis;
        }
    .ce-link-autocomplete__search-item-description {
            color: #7b7e89;

            font-size: 12px;
            line-height: 16px;
            margin-top: 1px;

            overflow:hidden;
            white-space:nowrap;
            text-overflow: ellipsis;
        }
    .ce-link-autocomplete__hidden {
        display: none;
    }
    .ce-link-autocomplete__link-data-wrapper {
            width: 200px;
            outline: none;
            border: 0;
            border-radius: 4px;
            font-size: 13px;
            padding: 10px;
            box-sizing: border-box;
        }
    .ce-link-autocomplete__link-data-title-wrapper {
            margin-bottom: 10px;
        }
    .ce-link-autocomplete__link-data-name {
            font-size: 14px;
            line-height: 16px;

            overflow:hidden;
            white-space:nowrap;
            text-overflow: ellipsis;
        }
    .ce-link-autocomplete__link-data-description {
            color: #7b7e89;

            font-size: 12px;
            line-height: 16px;
            margin-top: 1px;

            overflow:hidden;
            white-space:nowrap;
            text-overflow: ellipsis;
        }
    .ce-link-autocomplete__link-data-url {
            display: block;

            overflow:hidden;
            white-space:nowrap;
            text-overflow: ellipsis;
        }

@keyframes ce-link-autocomplete__spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
`,""]);const s=o},645:_=>{_.exports=function(m){var w=[];return w.toString=function(){return this.map(function(u){var o=m(u);return u[2]?"@media ".concat(u[2]," {").concat(o,"}"):o}).join("")},w.i=function(u,o,s){typeof u=="string"&&(u=[[null,u,""]]);var l={};if(s)for(var b=0;b<this.length;b++){var v=this[b][0];v!=null&&(l[v]=!0)}for(var C=0;C<u.length;C++){var d=[].concat(u[C]);s&&l[d[0]]||(o&&(d[2]?d[2]="".concat(o," and ").concat(d[2]):d[2]=o),w.push(d))}},w}},379:(_,m,w)=>{var u,o=function(){var n={};return function(r){if(n[r]===void 0){var h=document.querySelector(r);if(window.HTMLIFrameElement&&h instanceof window.HTMLIFrameElement)try{h=h.contentDocument.head}catch{h=null}n[r]=h}return n[r]}}(),s=[];function l(n){for(var r=-1,h=0;h<s.length;h++)if(s[h].identifier===n){r=h;break}return r}function b(n,r){for(var h={},x=[],E=0;E<n.length;E++){var R=n[E],T=r.base?R[0]+r.base:R[0],p=h[T]||0,a="".concat(T," ").concat(p);h[T]=p+1;var f=l(a),g={css:R[1],media:R[2],sourceMap:R[3]};f!==-1?(s[f].references++,s[f].updater(g)):s.push({identifier:a,updater:i(g,r),references:1}),x.push(a)}return x}function v(n){var r=document.createElement("style"),h=n.attributes||{};if(h.nonce===void 0){var x=w.nc;x&&(h.nonce=x)}if(Object.keys(h).forEach(function(R){r.setAttribute(R,h[R])}),typeof n.insert=="function")n.insert(r);else{var E=o(n.insert||"head");if(!E)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");E.appendChild(r)}return r}var C,d=(C=[],function(n,r){return C[n]=r,C.filter(Boolean).join(`
`)});function c(n,r,h,x){var E=h?"":x.media?"@media ".concat(x.media," {").concat(x.css,"}"):x.css;if(n.styleSheet)n.styleSheet.cssText=d(r,E);else{var R=document.createTextNode(E),T=n.childNodes;T[r]&&n.removeChild(T[r]),T.length?n.insertBefore(R,T[r]):n.appendChild(R)}}function S(n,r,h){var x=h.css,E=h.media,R=h.sourceMap;if(E?n.setAttribute("media",E):n.removeAttribute("media"),R&&typeof btoa<"u"&&(x+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(R))))," */")),n.styleSheet)n.styleSheet.cssText=x;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(x))}}var e=null,t=0;function i(n,r){var h,x,E;if(r.singleton){var R=t++;h=e||(e=v(r)),x=c.bind(null,h,R,!1),E=c.bind(null,h,R,!0)}else h=v(r),x=S.bind(null,h,r),E=function(){(function(T){if(T.parentNode===null)return!1;T.parentNode.removeChild(T)})(h)};return x(n),function(T){if(T){if(T.css===n.css&&T.media===n.media&&T.sourceMap===n.sourceMap)return;x(n=T)}else E()}}_.exports=function(n,r){(r=r||{}).singleton||typeof r.singleton=="boolean"||(r.singleton=(u===void 0&&(u=!!(window&&document&&document.all&&!window.atob)),u));var h=b(n=n||[],r);return function(x){if(x=x||[],Object.prototype.toString.call(x)==="[object Array]"){for(var E=0;E<h.length;E++){var R=l(h[E]);s[R].references--}for(var T=b(x,r),p=0;p<h.length;p++){var a=l(h[p]);s[a].references===0&&(s[a].updater(),s.splice(a,1))}h=T}}}}},M={};function N(_){if(M[_])return M[_].exports;var m=M[_]={id:_,exports:{}};return P[_](m,m.exports,N),m.exports}N.n=_=>{var m=_&&_.__esModule?()=>_.default:()=>_;return N.d(m,{a:m}),m},N.d=(_,m)=>{for(var w in m)N.o(m,w)&&!N.o(_,w)&&Object.defineProperty(_,w,{enumerable:!0,get:m[w]})},N.o=(_,m)=>Object.prototype.hasOwnProperty.call(_,m);var F={};return(()=>{N.d(F,{default:()=>c});var _=N(379),m=N.n(_),w=N(384);m()(w.Z,{insert:"head",singleton:!1}),w.Z.locals;var u=N(580),o=N.n(u);class s{static isNumber(e){return typeof e=="number"}static isArray(e){return Array.isArray(e)}static isUrl(e){return/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/.test(e)}}function l(S,e=null,t={}){const i=document.createElement(S);Array.isArray(e)?i.classList.add(...e):e&&i.classList.add(e);for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n]);return i}function b(S){return!(!S||!S.tagName)&&["INPUT","TEXTAREA"].includes(S.tagName)}class v{constructor(){this.selection=null,this.savedSelectionRange=null,this.isFakeBackgroundEnabled=!1,this.commandBackground="backColor",this.commandRemoveFormat="removeFormat"}static get anchorNode(){const e=window.getSelection();return e?e.anchorNode:null}static get anchorElement(){const e=window.getSelection();if(!e)return null;const t=e.anchorNode;return t?(i=t,!s.isNumber(i)&&i&&i.nodeType&&i.nodeType===Node.ELEMENT_NODE?t:t.parentElement):null;var i}static get anchorOffset(){const e=window.getSelection();return e?e.anchorOffset:null}static get isCollapsed(){const e=window.getSelection();return e?e.isCollapsed:null}static get isSelectionExists(){return!!v.get().anchorNode}static get range(){const e=window.getSelection();return e&&e.rangeCount?e.getRangeAt(0):null}static get rect(){let e,t=document.selection,i={x:0,y:0,width:0,height:0};if(t&&t.type!=="Control")return e=t.createRange(),i.x=e.boundingLeft,i.y=e.boundingTop,i.width=e.boundingWidth,i.height=e.boundingHeight,i;if(!window.getSelection)return console.warn("Method window.getSelection is not supported"),i;if(t=window.getSelection(),t.rangeCount===null||isNaN(t.rangeCount))return console.warn("Method SelectionUtils.rangeCount is not supported"),i;if(t.rangeCount===0)return i;if(e=t.getRangeAt(0).cloneRange(),e.getBoundingClientRect&&(i=e.getBoundingClientRect()),i.x===0&&i.y===0){const n=document.createElement("span");if(n.getBoundingClientRect){n.appendChild(document.createTextNode("​")),e.insertNode(n),i=n.getBoundingClientRect();const r=n.parentNode;r.removeChild(n),r.normalize()}}return i}static get text(){return window.getSelection?window.getSelection().toString():""}static get(){return window.getSelection()}static setCursor(e,t=0){const i=document.createRange(),n=window.getSelection();return b(e)?function(r){let h=!0;if(b(r))switch(r.type){case"file":case"checkbox":case"radio":case"hidden":case"submit":case"button":case"image":case"reset":h=!1}else h=r.contentEditable==="true";return h}(e)?(e.focus(),e.selectionStart=e.selectionEnd=t,e.getBoundingClientRect()):void 0:(i.setStart(e,t),i.setEnd(e,t),n.removeAllRanges(),n.addRange(i),i.getBoundingClientRect())}removeFakeBackground(){this.isFakeBackgroundEnabled&&(this.isFakeBackgroundEnabled=!1,document.execCommand(this.commandRemoveFormat))}setFakeBackground(){document.execCommand(this.commandBackground,!1,"#a8d6ff"),this.isFakeBackgroundEnabled=!0}save(){this.savedSelectionRange=v.range}restore(){if(!this.savedSelectionRange)return;const e=window.getSelection();e.removeAllRanges(),e.addRange(this.savedSelectionRange)}clearSaved(){this.savedSelectionRange=null}collapseToEnd(){const e=window.getSelection(),t=document.createRange();t.selectNodeContents(e.focusNode),t.collapse(!1),e.removeAllRanges(),e.addRange(t)}findParentTag(e,t,i=10){const n=window.getSelection();let r=null;return n&&n.anchorNode&&n.focusNode?([n.anchorNode,n.focusNode].forEach(h=>{let x=i;for(;x>0&&h.parentNode&&(h.tagName!==e||(r=h,t&&h.classList&&!h.classList.contains(t)&&(r=null),!r));)h=h.parentNode,x--}),r):null}expandToTag(e){const t=window.getSelection();t.removeAllRanges();const i=document.createRange();i.selectNodeContents(e),t.addRange(i)}}const C="Cannot process search request because of",d="Next";class c{static get isInline(){return!0}static get sanitize(){return{a:!0}}static get title(){return"Link Autocomplete"}get shortcut(){return"CMD+K"}static get CSS(){return{iconWrapper:"ce-link-autocomplete__icon-wrapper",hidden:"ce-link-autocomplete__hidden",actionsWrapper:"ce-link-autocomplete__actions-wrapper",field:"ce-link-autocomplete__field",fieldLoading:"ce-link-autocomplete__field--loading",fieldInput:"ce-link-autocomplete__field-input",foundItems:"ce-link-autocomplete__items",searchItem:"ce-link-autocomplete__search-item",searchItemSelected:"ce-link-autocomplete__search-item--selected",searchItemName:"ce-link-autocomplete__search-item-name",searchItemDescription:"ce-link-autocomplete__search-item-description",linkDataWrapper:"ce-link-autocomplete__link-data-wrapper",linkDataTitleWrapper:"ce-link-autocomplete__link-data-title-wrapper",linkDataName:"ce-link-autocomplete__link-data-name",linkDataDescription:"ce-link-autocomplete__link-data-description",linkDataURL:"ce-link-autocomplete__link-data-url"}}constructor({config:e,api:t}){this.api=t,this.config=e||{},this.selection=new v,this.searchEndpointUrl=this.config.endpoint,this.searchQueryParam=this.config.queryParam,this.nodes={toolButtons:null,toolButtonLink:null,toolButtonUnlink:null,actionsWrapper:null,inputWrapper:null,inputField:null,searchResults:null,linkDataWrapper:null,linkDataTitleWrapper:null,linkDataName:null,linkDataDescription:null,linkDataURL:null},this.tagName="A",this.KEYS={ENTER:13,UP:38,DOWN:40},this.typingTimer=null}render(){return this.nodes.toolButtons=l("button",this.api.styles.inlineToolButton),this.nodes.toolButtonLink=l("span",c.CSS.iconWrapper,{innerHTML:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M7.69998 12.6L7.67896 12.62C6.53993 13.7048 6.52012 15.5155 7.63516 16.625V16.625C8.72293 17.7073 10.4799 17.7102 11.5712 16.6314L13.0263 15.193C14.0703 14.1609 14.2141 12.525 13.3662 11.3266L13.22 11.12"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M16.22 11.12L16.3564 10.9805C17.2895 10.0265 17.3478 8.5207 16.4914 7.49733V7.49733C15.569 6.39509 13.9269 6.25143 12.8271 7.17675L11.39 8.38588C10.0935 9.47674 9.95704 11.4241 11.0887 12.6852L11.12 12.72"/></svg>'}),this.nodes.toolButtons.appendChild(this.nodes.toolButtonLink),this.nodes.toolButtonUnlink=l("span",c.CSS.iconWrapper,{innerHTML:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M15.7795 11.5C15.7795 11.5 16.053 11.1962 16.5497 10.6722C17.4442 9.72856 17.47 8.2475 16.578 7.30145V7.30145C15.6482 6.31522 14.0873 6.29227 13.1288 7.25073L11.8795 8.49999"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M8.24516 12.3883C8.24516 12.3883 7.9717 12.6922 7.47503 13.2161C6.5805 14.1598 6.55465 15.6408 7.44665 16.5869V16.5869C8.37652 17.5731 9.93743 17.5961 10.8959 16.6376L12.1452 15.3883"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M17.7802 15.1032L16.597 14.9422C16.0109 14.8624 15.4841 15.3059 15.4627 15.8969L15.4199 17.0818"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M6.39063 9.03238L7.58431 9.06668C8.17549 9.08366 8.65218 8.58665 8.61055 7.99669L8.52708 6.81397"/><line x1="12.1142" x2="11.7" y1="12.2" y2="11.7858" stroke="currentColor" stroke-linecap="round" stroke-width="2"/></svg>'}),this.nodes.toolButtons.appendChild(this.nodes.toolButtonUnlink),this.toggleVisibility(this.nodes.toolButtonUnlink,!1),this.nodes.toolButtons}renderActions(){return this.nodes.actionsWrapper=l("div",[c.CSS.actionsWrapper]),this.toggleVisibility(this.nodes.actionsWrapper,!1),this.nodes.inputWrapper=l("div",c.CSS.field),this.nodes.inputField=l("input",c.CSS.fieldInput,{placeholder:this.api.i18n.t(this.isServerEnabled?"Paste or search":"Paste a link")}),this.nodes.inputWrapper.appendChild(this.nodes.inputField),this.toggleVisibility(this.nodes.inputWrapper,!1),this.nodes.searchResults=l("div",c.CSS.foundItems),this.nodes.searchResults.addEventListener("mouseenter",()=>{this.getSearchItems().forEach(e=>{e.classList.remove(c.CSS.searchItemSelected)})}),this.nodes.searchResults.addEventListener("click",e=>{const t=e.target.closest(`.${c.CSS.searchItem}`);t&&(e.preventDefault(),e.stopPropagation(),this.searchItemPressed(t))}),this.nodes.inputField.addEventListener("keydown",this.fieldKeydownHandler.bind(this)),this.nodes.inputField.addEventListener("input",this.fieldInputHandler.bind(this)),this.nodes.linkDataWrapper=l("div",c.CSS.linkDataWrapper),this.toggleVisibility(this.nodes.linkDataWrapper,!1),this.nodes.linkDataTitleWrapper=l("div",c.CSS.linkDataTitleWrapper),this.nodes.linkDataWrapper.appendChild(this.nodes.linkDataTitleWrapper),this.toggleVisibility(this.nodes.linkDataTitleWrapper,!1),this.nodes.linkDataName=l("div",c.CSS.linkDataName),this.nodes.linkDataTitleWrapper.appendChild(this.nodes.linkDataName),this.nodes.linkDataDescription=l("div",c.CSS.linkDataDescription),this.nodes.linkDataTitleWrapper.appendChild(this.nodes.linkDataDescription),this.nodes.linkDataURL=l("A",c.CSS.linkDataURL),this.nodes.linkDataWrapper.appendChild(this.nodes.linkDataURL),this.nodes.actionsWrapper.appendChild(this.nodes.inputWrapper),this.nodes.actionsWrapper.appendChild(this.nodes.searchResults),this.nodes.actionsWrapper.appendChild(this.nodes.linkDataWrapper),this.nodes.actionsWrapper}fieldKeydownHandler(e){const t=[this.KEYS.UP,this.KEYS.DOWN].includes(e.keyCode),i=this.KEYS.ENTER===e.keyCode;if(t||i)switch(e.preventDefault(),e.stopPropagation(),!0){case t:{const n=e.keyCode===this.KEYS.DOWN?d:"Previous";this.navigate(n);break}case i:this.processEnterKeyPressed()}}fieldInputHandler(e){clearTimeout(this.typingTimer);const t=e.target.value;t&&t.trim()?s.isUrl(t)?this.generateSearchList([{href:t}]):this.isServerEnabled&&(this.typingTimer=setTimeout(async()=>{this.toggleLoadingState(!0);try{const i=await this.searchRequest(t);this.generateSearchList(i)}catch(i){o().show({message:`${C} "${i.message}"`,style:"error"})}this.toggleLoadingState(!1)},250)):this.clearSearchList()}toggleLoadingState(e){this.nodes.inputWrapper.classList.toggle(c.CSS.fieldLoading,e)}navigate(e){const t=this.getSearchItems(),i=this.getSelectedItem();if(!t.length)return;const n=e===d?1:-1;let r=(i?t.indexOf(i):-1)+n;r>t.length-1?r=0:r<0&&(r=t.length-1),i&&i.classList.remove(c.CSS.searchItemSelected),t[r].classList.add(c.CSS.searchItemSelected)}processEnterKeyPressed(){const e=this.getSelectedItem();if(e)return void this.searchItemPressed(e);const t=this.nodes.inputField.value;if(!t||!t.trim())return;if(!s.isUrl(t))return void o().show({message:"Link URL is invalid",style:"error"});const i=this.getSearchItems()[0];this.searchItemPressed(i)}getSearchItems(){const e=this.nodes.searchResults.querySelectorAll(`.${c.CSS.searchItem}`);return Array.from(e)}getSelectedItem(){return this.nodes.searchResults.querySelector(`.${c.CSS.searchItemSelected}`)}clearSearchList(){this.nodes.searchResults.innerHTML=""}generateSearchList(e=[]){this.clearSearchList(),s.isArray(e)?e.length!==0&&e.forEach(t=>{const i=l("div",[c.CSS.searchItem]),n=l("div",[c.CSS.searchItemName],{innerText:t.name||t.href});if(i.appendChild(n),t.description){const r=l("div",[c.CSS.searchItemDescription],{innerText:t.description});i.appendChild(r)}Object.keys(t).forEach(r=>{i.dataset[r]=t[r]}),this.nodes.searchResults.appendChild(i)}):o().show({message:"Server responded with invalid data",style:"error"})}searchItemPressed(e){if(!e.dataset||!e.dataset.href)return;const t=e.dataset.href;this.selection.restore(),this.selection.removeFakeBackground(),document.execCommand("createLink",!1,t);const i=this.selection.findParentTag(this.tagName);Object.keys(e.dataset).forEach(n=>{n!=="href"&&(i.dataset[n]=e.dataset[n])}),this.selection.collapseToEnd(),this.api.inlineToolbar.close()}surround(e){if(!e)return;this.toggleVisibility(this.nodes.actionsWrapper,!0);const t=this.nodes.toolButtonUnlink.classList.contains(this.api.styles.inlineToolButtonActive);if(this.selection.setFakeBackground(),this.selection.save(),t){const i=this.selection.findParentTag("A");this.selection.expandToTag(i),document.execCommand("unlink"),this.selection.removeFakeBackground(),this.api.inlineToolbar.close()}else this.toggleVisibility(this.nodes.inputWrapper,!0),this.nodes.inputField.focus()}checkState(e){if(!e.anchorNode)return;const t=this.selection.findParentTag(this.tagName);t&&(this.toggleVisibility(this.nodes.actionsWrapper,!0),this.nodes.linkDataName.innerText=t.dataset.name||"",this.nodes.linkDataDescription.innerText=t.dataset.description||"",this.nodes.linkDataURL.innerText=t.href||"",this.nodes.linkDataURL.href=t.href||"",this.nodes.linkDataURL.target="_blank",(t.dataset.name||t.dataset.description)&&this.toggleVisibility(this.nodes.linkDataTitleWrapper,!0),this.toggleVisibility(this.nodes.linkDataWrapper,!0),this.toggleVisibility(this.nodes.toolButtonLink,!1),this.toggleVisibility(this.nodes.toolButtonUnlink,!0),this.nodes.toolButtonUnlink.classList.add(this.api.styles.inlineToolButtonActive))}toggleVisibility(e,t=!0){e.classList.toggle(c.CSS.hidden,!t)}async searchRequest(e){const t=new URLSearchParams({[this.searchQueryParam]:e}).toString();try{const i=await fetch(`${this.searchEndpointUrl}?${t}`),n=await i.json();if(n&&n.success)return n.items;console.warn('Link Autocomplete: invalid response format: "success: true" expected, but got %o. Response: %o',n.success,n)}catch(i){o().show({message:`${C} "${i.message}"`,style:"error"})}return[]}isServerEnabled(){return!!this.searchEndpointUrl}clear(){if(this.selection.isFakeBackgroundEnabled){const e=new v;e.save(),this.selection.restore(),this.selection.removeFakeBackground(),this.selection.clearSaved(),e.restore()}}}})(),F.default})()})})(U);var H=U.exports;return W(H)});
