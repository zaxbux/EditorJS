(function(E,k){typeof exports=="object"&&typeof module<"u"?module.exports=k():typeof define=="function"&&define.amd?define(k):(E=typeof globalThis<"u"?globalThis:E||self,E.Embed=k())})(this,function(){"use strict";function E(U){return U&&U.__esModule&&Object.prototype.hasOwnProperty.call(U,"default")?U.default:U}var k={exports:{}};(function(U,P){(function(h,g){U.exports=g()})(window,function(){return function(h){var g={};function t(r){if(g[r])return g[r].exports;var e=g[r]={i:r,l:!1,exports:{}};return h[r].call(e.exports,e,e.exports,t),e.l=!0,e.exports}return t.m=h,t.c=g,t.d=function(r,e,c){t.o(r,e)||Object.defineProperty(r,e,{enumerable:!0,get:c})},t.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},t.t=function(r,e){if(1&e&&(r=t(r)),8&e||4&e&&typeof r=="object"&&r&&r.__esModule)return r;var c=Object.create(null);if(t.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:r}),2&e&&typeof r!="string")for(var i in r)t.d(c,i,function(b){return r[b]}.bind(null,i));return c},t.n=function(r){var e=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(e,"a",e),e},t.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},t.p="/",t(t.s=14)}([function(h,g,t){var r=t(5),e=t(6),c=t(7),i=t(9);h.exports=function(b,y){return r(b)||e(b,y)||c(b,y)||i()}},function(h,g){function t(r){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?h.exports=t=function(e){return typeof e}:h.exports=t=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(r)}h.exports=t},function(h,g){h.exports=function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}},function(h,g){function t(r,e){for(var c=0;c<e.length;c++){var i=e[c];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}h.exports=function(r,e,c){return e&&t(r.prototype,e),c&&t(r,c),r}},function(h,g){function t(r,e,c){var i,b,y,_,x;function j(){var C=Date.now()-_;C<e&&C>=0?i=setTimeout(j,e-C):(i=null,c||(x=r.apply(y,b),y=b=null))}e==null&&(e=100);var S=function(){y=this,b=arguments,_=Date.now();var C=c&&!i;return i||(i=setTimeout(j,e)),C&&(x=r.apply(y,b),y=b=null),x};return S.clear=function(){i&&(clearTimeout(i),i=null)},S.flush=function(){i&&(x=r.apply(y,b),y=b=null,clearTimeout(i),i=null)},S}t.debounce=t,h.exports=t},function(h,g){h.exports=function(t){if(Array.isArray(t))return t}},function(h,g){h.exports=function(t,r){if(typeof Symbol<"u"&&Symbol.iterator in Object(t)){var e=[],c=!0,i=!1,b=void 0;try{for(var y,_=t[Symbol.iterator]();!(c=(y=_.next()).done)&&(e.push(y.value),!r||e.length!==r);c=!0);}catch(x){i=!0,b=x}finally{try{c||_.return==null||_.return()}finally{if(i)throw b}}return e}}},function(h,g,t){var r=t(8);h.exports=function(e,c){if(e){if(typeof e=="string")return r(e,c);var i=Object.prototype.toString.call(e).slice(8,-1);return i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set"?Array.from(i):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?r(e,c):void 0}}},function(h,g){h.exports=function(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,c=new Array(r);e<r;e++)c[e]=t[e];return c}},function(h,g){h.exports=function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}},function(h,g,t){var r=t(11),e=t(12);typeof(e=e.__esModule?e.default:e)=="string"&&(e=[[h.i,e,""]]);var c={insert:"head",singleton:!1};r(e,c),h.exports=e.locals||{}},function(h,g,t){var r,e=function(){return r===void 0&&(r=!!(window&&document&&document.all&&!window.atob)),r},c=function(){var o={};return function(a){if(o[a]===void 0){var n=document.querySelector(a);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch{n=null}o[a]=n}return o[a]}}(),i=[];function b(o){for(var a=-1,n=0;n<i.length;n++)if(i[n].identifier===o){a=n;break}return a}function y(o,a){for(var n={},d=[],m=0;m<o.length;m++){var l=o[m],s=a.base?l[0]+a.base:l[0],v=n[s]||0,w="".concat(s," ").concat(v);n[s]=v+1;var O=b(w),L={css:l[1],media:l[2],sourceMap:l[3]};O!==-1?(i[O].references++,i[O].updater(L)):i.push({identifier:w,updater:f(L,a),references:1}),d.push(w)}return d}function _(o){var a=document.createElement("style"),n=o.attributes||{};if(n.nonce===void 0){var d=t.nc;d&&(n.nonce=d)}if(Object.keys(n).forEach(function(l){a.setAttribute(l,n[l])}),typeof o.insert=="function")o.insert(a);else{var m=c(o.insert||"head");if(!m)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");m.appendChild(a)}return a}var x,j=(x=[],function(o,a){return x[o]=a,x.filter(Boolean).join(`
`)});function S(o,a,n,d){var m=n?"":d.media?"@media ".concat(d.media," {").concat(d.css,"}"):d.css;if(o.styleSheet)o.styleSheet.cssText=j(a,m);else{var l=document.createTextNode(m),s=o.childNodes;s[a]&&o.removeChild(s[a]),s.length?o.insertBefore(l,s[a]):o.appendChild(l)}}function C(o,a,n){var d=n.css,m=n.media,l=n.sourceMap;if(m?o.setAttribute("media",m):o.removeAttribute("media"),l&&btoa&&(d+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(l))))," */")),o.styleSheet)o.styleSheet.cssText=d;else{for(;o.firstChild;)o.removeChild(o.firstChild);o.appendChild(document.createTextNode(d))}}var p=null,u=0;function f(o,a){var n,d,m;if(a.singleton){var l=u++;n=p||(p=_(a)),d=S.bind(null,n,l,!1),m=S.bind(null,n,l,!0)}else n=_(a),d=C.bind(null,n,a),m=function(){(function(s){if(s.parentNode===null)return!1;s.parentNode.removeChild(s)})(n)};return d(o),function(s){if(s){if(s.css===o.css&&s.media===o.media&&s.sourceMap===o.sourceMap)return;d(o=s)}else m()}}h.exports=function(o,a){(a=a||{}).singleton||typeof a.singleton=="boolean"||(a.singleton=e());var n=y(o=o||[],a);return function(d){if(d=d||[],Object.prototype.toString.call(d)==="[object Array]"){for(var m=0;m<n.length;m++){var l=b(n[m]);i[l].references--}for(var s=y(d,a),v=0;v<n.length;v++){var w=b(n[v]);i[w].references===0&&(i[w].updater(),i.splice(w,1))}n=s}}}},function(h,g,t){(g=t(13)(!1)).push([h.i,`.embed-tool--loading .embed-tool__caption {
      display: none;
    }

    .embed-tool--loading .embed-tool__preloader {
      display: block;
    }

    .embed-tool--loading .embed-tool__content {
      display: none;
    }
  .embed-tool__preloader {
    display: none;
    position: relative;
    height: 200px;
    box-sizing: border-box;
    border-radius: 5px;
    border: 1px solid #e6e9eb;
  }
  .embed-tool__preloader::before {
      content: '';
      position: absolute;
      z-index: 3;
      left: 50%;
      top: 50%;
      width: 30px;
      height: 30px;
      margin-top: -25px;
      margin-left: -15px;
      border-radius: 50%;
      border: 2px solid #cdd1e0;
      border-top-color: #388ae5;
      box-sizing: border-box;
      animation: embed-preloader-spin 2s infinite linear;
    }
  .embed-tool__url {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    max-width: 250px;
    color: #7b7e89;
    font-size: 11px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .embed-tool__content {
    width: 100%;
  }
  .embed-tool__caption {
    margin-top: 7px;
  }
  .embed-tool__caption[contentEditable=true][data-placeholder]::before{
      position: absolute;
      content: attr(data-placeholder);
      color: #707684;
      font-weight: normal;
      opacity: 0;
    }
  .embed-tool__caption[contentEditable=true][data-placeholder]:empty::before {
         opacity: 1;
      }
  .embed-tool__caption[contentEditable=true][data-placeholder]:empty:focus::before {
        opacity: 0;
      }

@keyframes embed-preloader-spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}
`,""]),h.exports=g},function(h,g,t){h.exports=function(r){var e=[];return e.toString=function(){return this.map(function(c){var i=function(b,y){var _=b[1]||"",x=b[3];if(!x)return _;if(y&&typeof btoa=="function"){var j=(C=x,p=btoa(unescape(encodeURIComponent(JSON.stringify(C)))),u="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(p),"/*# ".concat(u," */")),S=x.sources.map(function(f){return"/*# sourceURL=".concat(x.sourceRoot||"").concat(f," */")});return[_].concat(S).concat([j]).join(`
`)}var C,p,u;return[_].join(`
`)}(c,r);return c[2]?"@media ".concat(c[2]," {").concat(i,"}"):i}).join("")},e.i=function(c,i,b){typeof c=="string"&&(c=[[null,c,""]]);var y={};if(b)for(var _=0;_<this.length;_++){var x=this[_][0];x!=null&&(y[x]=!0)}for(var j=0;j<c.length;j++){var S=[].concat(c[j]);b&&y[S[0]]||(i&&(S[2]?S[2]="".concat(i," and ").concat(S[2]):S[2]=i),e.push(S))}},e}},function(h,g,t){t.r(g),t.d(g,"default",function(){return C});var r=t(1),e=t.n(r),c=t(0),i=t.n(c),b=t(2),y=t.n(b),_=t(3),x=t.n(_),j={vimeo:{regex:/(?:http[s]?:\/\/)?(?:www.)?(?:player.)?vimeo\.co(?:.+\/([^\/]\d+)(?:#t=[\d]+)?s?$)/,embedUrl:"https://player.vimeo.com/video/<%= remote_id %>?title=0&byline=0",html:'<iframe style="width:100%;" height="320" frameborder="0"></iframe>',height:320,width:580},youtube:{regex:/(?:https?:\/\/)?(?:www\.)?(?:(?:youtu\.be\/)|(?:youtube\.com)\/(?:v\/|u\/\w\/|embed\/|watch))(?:(?:\?v=)?([^#&?=]*))?((?:[?&]\w*=\w*)*)/,embedUrl:"https://www.youtube.com/embed/<%= remote_id %>",html:'<iframe style="width:100%;" height="320" frameborder="0" allowfullscreen></iframe>',height:320,width:580,id:function(p){var u=i()(p,2),f=u[0],o=u[1];if(!o&&f)return f;var a={start:"start",end:"end",t:"start",time_continue:"start",list:"list"};return o=o.slice(1).split("&").map(function(n){var d=n.split("="),m=i()(d,2),l=m[0],s=m[1];return f||l!=="v"?a[l]?s==="LL"||s.startsWith("RDMM")||s.startsWith("FL")?null:"".concat(a[l],"=").concat(s):null:(f=s,null)}).filter(function(n){return!!n}),f+"?"+o.join("&")}},coub:{regex:/https?:\/\/coub\.com\/view\/([^\/\?\&]+)/,embedUrl:"https://coub.com/embed/<%= remote_id %>",html:'<iframe style="width:100%;" height="320" frameborder="0" allowfullscreen></iframe>',height:320,width:580},vine:{regex:/https?:\/\/vine\.co\/v\/([^\/\?\&]+)/,embedUrl:"https://vine.co/v/<%= remote_id %>/embed/simple/",html:'<iframe style="width:100%;" height="320" frameborder="0" allowfullscreen></iframe>',height:320,width:580},imgur:{regex:/https?:\/\/(?:i\.)?imgur\.com.*\/([a-zA-Z0-9]+)(?:\.gifv)?/,embedUrl:"http://imgur.com/<%= remote_id %>/embed",html:'<iframe allowfullscreen="true" scrolling="no" id="imgur-embed-iframe-pub-<%= remote_id %>" class="imgur-embed-iframe-pub" style="height: 500px; width: 100%; border: 1px solid #000"></iframe>',height:500,width:540},gfycat:{regex:/https?:\/\/gfycat\.com(?:\/detail)?\/([a-zA-Z]+)/,embedUrl:"https://gfycat.com/ifr/<%= remote_id %>",html:`<iframe frameborder='0' scrolling='no' style="width:100%;" height='436' allowfullscreen ></iframe>`,height:436,width:580},"twitch-channel":{regex:/https?:\/\/www\.twitch\.tv\/([^\/\?\&]*)\/?$/,embedUrl:"https://player.twitch.tv/?channel=<%= remote_id %>",html:'<iframe frameborder="0" allowfullscreen="true" scrolling="no" height="366" style="width:100%;"></iframe>',height:366,width:600},"twitch-video":{regex:/https?:\/\/www\.twitch\.tv\/(?:[^\/\?\&]*\/v|videos)\/([0-9]*)/,embedUrl:"https://player.twitch.tv/?video=v<%= remote_id %>",html:'<iframe frameborder="0" allowfullscreen="true" scrolling="no" height="366" style="width:100%;"></iframe>',height:366,width:600},"yandex-music-album":{regex:/https?:\/\/music\.yandex\.ru\/album\/([0-9]*)\/?$/,embedUrl:"https://music.yandex.ru/iframe/#album/<%= remote_id %>/",html:'<iframe frameborder="0" style="border:none;width:540px;height:400px;" style="width:100%;" height="400"></iframe>',height:400,width:540},"yandex-music-track":{regex:/https?:\/\/music\.yandex\.ru\/album\/([0-9]*)\/track\/([0-9]*)/,embedUrl:"https://music.yandex.ru/iframe/#track/<%= remote_id %>/",html:'<iframe frameborder="0" style="border:none;width:540px;height:100px;" style="width:100%;" height="100"></iframe>',height:100,width:540,id:function(p){return p.join("/")}},"yandex-music-playlist":{regex:/https?:\/\/music\.yandex\.ru\/users\/([^\/\?\&]*)\/playlists\/([0-9]*)/,embedUrl:"https://music.yandex.ru/iframe/#playlist/<%= remote_id %>/show/cover/description/",html:'<iframe frameborder="0" style="border:none;width:540px;height:400px;" width="540" height="400"></iframe>',height:400,width:540,id:function(p){return p.join("/")}},codepen:{regex:/https?:\/\/codepen\.io\/([^\/\?\&]*)\/pen\/([^\/\?\&]*)/,embedUrl:"https://codepen.io/<%= remote_id %>?height=300&theme-id=0&default-tab=css,result&embed-version=2",html:"<iframe height='300' scrolling='no' frameborder='no' allowtransparency='true' allowfullscreen='true' style='width: 100%;'></iframe>",height:300,width:600,id:function(p){return p.join("/embed/")}},instagram:{regex:/https?:\/\/www\.instagram\.com\/p\/([^\/\?\&]+)\/?.*/,embedUrl:"https://www.instagram.com/p/<%= remote_id %>/embed",html:'<iframe width="400" height="505" style="margin: 0 auto;" frameborder="0" scrolling="no" allowtransparency="true"></iframe>',height:505,width:400},twitter:{regex:/^https?:\/\/twitter\.com\/(?:#!\/)?(\w+)\/status(?:es)?\/(\d+?.*)?$/,embedUrl:"https://twitframe.com/show?url=https://twitter.com/<%= remote_id %>",html:'<iframe width="600" height="600" style="margin: 0 auto;" frameborder="0" scrolling="no" allowtransparency="true"></iframe>',height:300,width:600,id:function(p){return p.join("/status/")}},pinterest:{regex:/https?:\/\/([^\/\?\&]*).pinterest.com\/pin\/([^\/\?\&]*)\/?$/,embedUrl:"https://assets.pinterest.com/ext/embed.html?id=<%= remote_id %>",html:"<iframe scrolling='no' frameborder='no' allowtransparency='true' allowfullscreen='true' style='width: 100%; min-height: 400px; max-height: 1000px;'></iframe>",id:function(p){return p[1]}},facebook:{regex:/https?:\/\/www.facebook.com\/([^\/\?\&]*)\/(.*)/,embedUrl:"https://www.facebook.com/plugins/post.php?href=https://www.facebook.com/<%= remote_id %>&width=500",html:"<iframe scrolling='no' frameborder='no' allowtransparency='true' allowfullscreen='true' style='width: 100%; min-height: 500px; max-height: 1000px;'></iframe>",id:function(p){return p.join("/")}},aparat:{regex:/(?:http[s]?:\/\/)?(?:www.)?aparat\.com\/v\/([^\/\?\&]+)\/?/,embedUrl:"https://www.aparat.com/video/video/embed/videohash/<%= remote_id %>/vt/frame",html:'<iframe width="600" height="300" style="margin: 0 auto;" frameborder="0" scrolling="no" allowtransparency="true"></iframe>',height:300,width:600},miro:{regex:/https:\/\/miro.com\/\S+(\S{12})\/(\S+)?/,embedUrl:"https://miro.com/app/live-embed/<%= remote_id %>",html:'<iframe width="700" height="500" style="margin: 0 auto;" allowFullScreen frameBorder="0" scrolling="no"></iframe>'}},S=(t(10),t(4)),C=function(){function p(u){var f=u.data,o=u.api,a=u.readOnly;y()(this,p),this.api=o,this._data={},this.element=null,this.readOnly=a,this.data=f}return x()(p,[{key:"render",value:function(){var u=this;if(!this.data.service){var f=document.createElement("div");return this.element=f,f}var o=p.services[this.data.service].html,a=document.createElement("div"),n=document.createElement("div"),d=document.createElement("template"),m=this.createPreloader();a.classList.add(this.CSS.baseClass,this.CSS.container,this.CSS.containerLoading),n.classList.add(this.CSS.input,this.CSS.caption),a.appendChild(m),n.contentEditable=!this.readOnly,n.dataset.placeholder=this.api.i18n.t("Enter a caption"),n.innerHTML=this.data.caption||"",d.innerHTML=o,d.content.firstChild.setAttribute("src",this.data.embed),d.content.firstChild.classList.add(this.CSS.content);var l=this.embedIsReady(a);return a.appendChild(d.content.firstChild),a.appendChild(n),l.then(function(){a.classList.remove(u.CSS.containerLoading)}),this.element=a,a}},{key:"createPreloader",value:function(){var u=document.createElement("preloader"),f=document.createElement("div");return f.textContent=this.data.source,u.classList.add(this.CSS.preloader),f.classList.add(this.CSS.url),u.appendChild(f),u}},{key:"save",value:function(){return this.data}},{key:"onPaste",value:function(u){var f=u.detail,o=f.key,a=f.data,n=p.services[o],d=n.regex,m=n.embedUrl,l=n.width,s=n.height,v=n.id,w=v===void 0?function(T){return T.shift()}:v,O=d.exec(a).slice(1),L=m.replace(/<%= remote_id %>/g,w(O));this.data={service:o,source:a,embed:L,width:l,height:s}}},{key:"embedIsReady",value:function(u){var f=null;return new Promise(function(o,a){(f=new MutationObserver(Object(S.debounce)(o,450))).observe(u,{childList:!0,subtree:!0})}).then(function(){f.disconnect()})}},{key:"data",set:function(u){if(!(u instanceof Object))throw Error("Embed Tool data should be object");var f=u.service,o=u.source,a=u.embed,n=u.width,d=u.height,m=u.caption,l=m===void 0?"":m;this._data={service:f||this.data.service,source:o||this.data.source,embed:a||this.data.embed,width:n||this.data.width,height:d||this.data.height,caption:l||this.data.caption||""};var s=this.element;s&&s.parentNode.replaceChild(this.render(),s)},get:function(){if(this.element){var u=this.element.querySelector(".".concat(this.api.styles.input));this._data.caption=u?u.innerHTML:""}return this._data}},{key:"CSS",get:function(){return{baseClass:this.api.styles.block,input:this.api.styles.input,container:"embed-tool",containerLoading:"embed-tool--loading",preloader:"embed-tool__preloader",caption:"embed-tool__caption",url:"embed-tool__url",content:"embed-tool__content"}}}],[{key:"prepare",value:function(u){var f=u.config,o=(f===void 0?{}:f).services,a=o===void 0?{}:o,n=Object.entries(j),d=Object.entries(a).filter(function(l){var s=i()(l,2),v=(s[0],s[1]);return typeof v=="boolean"&&v===!0}).map(function(l){return i()(l,1)[0]}),m=Object.entries(a).filter(function(l){var s=i()(l,2),v=(s[0],s[1]);return e()(v)==="object"}).filter(function(l){var s=i()(l,2),v=(s[0],s[1]);return p.checkServiceConfig(v)}).map(function(l){var s=i()(l,2),v=s[0],w=s[1];return[v,{regex:w.regex,embedUrl:w.embedUrl,html:w.html,height:w.height,width:w.width,id:w.id}]});d.length&&(n=n.filter(function(l){var s=i()(l,1)[0];return d.includes(s)})),n=n.concat(m),p.services=n.reduce(function(l,s){var v=i()(s,2),w=v[0],O=v[1];return w in l?(l[w]=Object.assign({},l[w],O),l):(l[w]=O,l)},{}),p.patterns=n.reduce(function(l,s){var v=i()(s,2),w=v[0],O=v[1];return l[w]=O.regex,l},{})}},{key:"checkServiceConfig",value:function(u){var f=u.regex,o=u.embedUrl,a=u.html,n=u.height,d=u.width,m=u.id,l=f&&f instanceof RegExp&&o&&typeof o=="string"&&a&&typeof a=="string";return l=(l=(l=l&&(m===void 0||m instanceof Function))&&(n===void 0||Number.isFinite(n)))&&(d===void 0||Number.isFinite(d))}},{key:"pasteConfig",get:function(){return{patterns:p.patterns}}},{key:"isReadOnlySupported",get:function(){return!0}}]),p}()}]).default})})(k);var M=k.exports;return E(M)});
